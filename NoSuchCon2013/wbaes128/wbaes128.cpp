/*
    wbaes128.cpp - NoSuchCon 2013 Crackme AES Whitebox without ASM obfuscation.
    Copyright (C) 2013 Axel "0vercl0k" Souchet - http://www.twitter.com/0vercl0k

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
    
    Kudos for @elvanderb for that really awesome-tough-motherfuckin-challenge.
    @kutioo source of entropy since 1337.
*/
#include <stdio.h>
#include <windows.h>
#include "wbaes128.h"

void hexdump(unsigned char *data, unsigned int amount)
{
    unsigned int dp, p;
    const char trans[] =
    "................................ !\"#$%&'()*+,-./0123456789"
    ":;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklm"
    "nopqrstuvwxyz{|}~...................................."
    "....................................................."
    "........................................";
    
    for (dp = 1; dp <= amount; dp++)
    {
        printf ("%02x ", data[dp-1]);
        if ((dp % 8) == 0)
            printf (" ");
        if ((dp % 16) == 0)
        {
            printf ("| ");
            p = dp;
            for (dp -= 16; dp < p; dp++)
                printf ("%c", trans[data[dp]]);
            printf ("\n");
        }
    }
    if ((amount % 16) != 0)
    {
        p = dp = 16 - (amount % 16);
        for (dp = p; dp > 0; dp--)
        {
            printf ("   ");
            if (((dp % 8) == 0) && (p != 8))
                printf (" ");
        }
        printf (" | ");
        for (dp = (amount - (16 - p)); dp < amount; dp++)
            printf ("%c", trans[data[dp]]);
    }
    printf ("\n");
}

void wbaes128_enc(unsigned char key[16], unsigned char out[16])
{
    unsigned char memory[100] = {0};
    memory[13] = TH_0054F184[key[0xe]];
    memory[64] = TH_00605BC8[key[0xc]];
    memory[54] = T_00430909[key[0x0]];
    memory[83] = T_00550AA4[key[0xe]];
    memory[59] = TH_0055ACDF[key[0x3]];
    memory[0] = TH_0043E740[key[0xd]];
    memory[68] = T_005B71A8[key[0xb]];
    memory[35] = TH_0042D6CD[key[0x9]];
    memory[99] = T_0054AFF9[key[0x8]];
    memory[5] = T_004E19C5[key[0xa]];
    memory[29] = T_0055BF00[key[0xf]];
    memory[66] = T_005CA23E[key[0xe]];
    memory[4] = T_005C1BF2[key[0xc]];
    memory[75] = T_004B765D[key[0x1]];
    memory[46] = T_005B8E5C[key[0x4]];
    memory[80] = T_004E8F8C[key[0x7]];
    memory[41] = T16_00415EFE[memory[35]][memory[13]];
    memory[55] = T_005899A3[key[0x8]];
    memory[23] = TH_005D3C2C[key[0xf]];
    memory[30] = T_0061487A[key[0x6]];
    memory[44] = T16_00415EFE[memory[5]][memory[29]];
    memory[10] = T_0043584A[key[0xa]];
    memory[2] = T_0051ECCD[key[0x7]];
    memory[27] = T_00543307[key[0x9]];
    memory[49] = TH_004DB25D[key[0xf]];
    memory[45] = T16_0050C7B8[memory[75]][memory[30]];
    memory[76] = TH_004D3B58[key[0xa]];
    out[0x2] = T_0057247B[key[0x1]];
    memory[60] = T_005B9172[key[0x7]];
    memory[17] = T_0042759C[key[0xc]];
    memory[16] = TH_005ED212[key[0x9]];
    memory[22] = T16_00415EFE[memory[68]][memory[4]];
    out[0xf] = T_004EB656[key[0x6]];
    memory[67] = T16_0050C7B8[out[0x2]][out[0xf]];
    memory[24] = TH_006151EB[key[0xc]];
    memory[19] = T16_00415EFE[memory[27]][memory[66]];
    memory[35] = T16_00415EFE[memory[76]][memory[23]];
    memory[96] = TH_004DF6BB[key[0x8]];
    memory[31] = TH_005FF3D0[key[0x1]];
    memory[94] = T_004B6115[key[0x3]];
    out[0xc] = T16_0050C7B8[memory[59]][memory[46]];
    out[0x0] = TH_004E567C[key[0x0]];
    memory[95] = T_00438C5E[key[0x0]];
    memory[8] = T_00554AAB[key[0x4]];
    out[0x6] = T_004A3C76[key[0x3]];
    memory[20] = T16_0050C7B8[memory[94]][memory[8]];
    memory[40] = T_004EB1FE[key[0x7]];
    memory[50] = TH_00543B97[key[0x9]];
    memory[39] = TH_005B3F86[key[0xb]];
    memory[29] = TH_0044709C[key[0xb]];
    memory[77] = T_0045FB03[key[0x0]];
    memory[9] = TH_00553461[key[0x4]];
    memory[99] = T16_00415EFE[memory[99]][memory[0]];
    memory[82] = T_0051CFC7[key[0x2]];
    memory[75] = T16_00415EFE[memory[29]][memory[17]];
    memory[11] = T16_0050C7B8[memory[82]][memory[40]];
    memory[98] = T_00582673[key[0x2]];
    memory[17] = TH_0047906A[key[0x6]];
    memory[26] = TH_005AE5CB[key[0xf]];
    out[0xe] = T16_0050C7B8[memory[98]][memory[80]];
    memory[37] = T_00538E75[key[0x3]];
    memory[73] = T16_0050C7B8[memory[31]][memory[17]];
    memory[25] = T16_004EF23E[memory[73]][memory[22]];
    memory[12] = T16_00415EFE[memory[10]][memory[49]];
    memory[72] = TH_00479E07[key[0x4]];
    memory[22] = T_005D01E5[key[0xd]];
    memory[53] = T16_004EF23E[memory[67]][memory[75]];
    memory[38] = T_005CD110[memory[53]];
    memory[63] = TH_005DF8BB[memory[53]];
    memory[23] = T_0044B82D[memory[25]];
    memory[52] = T16_00415EFE[memory[50]][memory[83]];
    memory[42] = T_0047DAAC[memory[25]];
    memory[76] = T16_00415EFE[memory[39]][memory[24]];
    memory[10] = T_0040F763[key[0xd]];
    memory[29] = T16_00415EFE[memory[55]][memory[22]];
    memory[92] = T_006023BC[key[0x8]];
    memory[98] = T_004A33EA[memory[53]];
    memory[3] = T_005EDB6A[key[0x1]];
    memory[40] = T_00541EC9[memory[25]];
    memory[53] = TH_00527045[memory[53]];
    memory[73] = TH_00533D7D[key[0x2]];
    memory[28] = T16_00415EFE[memory[96]][memory[10]];
    memory[59] = TH_004D2B65[key[0xe]];
    memory[66] = TH_004C65D4[memory[25]];
    memory[94] = T16_0050C7B8[memory[37]][memory[9]];
    out[0x5] = T16_0050C7B8[memory[73]][memory[60]];
    out[0xf] = TH_00502CD2[key[0xd]];
    memory[60] = T_0042733A[key[0x6]];
    memory[17] = T16_0050C7B8[out[0x6]][memory[72]];
    out[0x9] = T16_004EF23E[memory[94]][memory[19]];
    memory[75] = T_004DF02B[key[0x5]];
    memory[7] = T16_0050C7B8[memory[54]][memory[75]];
    memory[3] = T16_0050C7B8[memory[3]][memory[60]];
    memory[83] = T_0040D386[out[0x9]];
    memory[73] = T16_004EF23E[memory[3]][memory[76]];
    memory[61] = T16_004EF23E[memory[7]][memory[44]];
    memory[94] = T16_004EF23E[memory[17]][memory[41]];
    memory[96] = T16_00415EFE[memory[16]][memory[59]];
    memory[24] = T16_004EF23E[out[0xe]][memory[99]];
    memory[68] = T_0045102A[key[0x5]];
    memory[72] = TH_004EC336[key[0x5]];
    out[0x2] = TH_005C085A[memory[73]];
    memory[14] = T16_0050C7B8[memory[77]][memory[72]];
    memory[78] = T_00492ADF[memory[94]];
    memory[68] = T16_0050C7B8[out[0x0]][memory[68]];
    out[0x3] = T16_004EF23E[memory[11]][memory[28]];
    memory[25] = T_00554D97[memory[73]];
    memory[54] = T_005FCF50[key[0x5]];
    memory[8] = TH_0054DC4E[key[0xb]];
    out[0x0] = T16_004EF23E[memory[20]][memory[52]];
    memory[99] = T16_00415EFE[memory[8]][memory[64]];
    memory[92] = T16_00415EFE[memory[92]][out[0xf]];
    memory[62] = T_00446CB5[memory[24]];
    memory[93] = T16_004EF23E[out[0xc]][memory[96]];
    memory[37] = T_005DF1B0[memory[24]];
    memory[36] = T_005EE523[out[0x0]];
    memory[97] = TH_005E4E34[out[0x3]];
    out[0xc] = T_0047333E[memory[61]];
    memory[91] = T_00555127[memory[24]];
    memory[39] = TH_005DA709[memory[61]];
    memory[17] = T_0057EFC4[memory[73]];
    memory[41] = TH_0042CED6[out[0x0]];
    memory[64] = T_0045C489[out[0x9]];
    memory[48] = T_0049A73D[memory[73]];
    memory[22] = T_005EB74F[memory[94]];
    out[0xb] = T_0056E697[memory[93]];
    memory[84] = T16_0050C7B8[memory[95]][memory[54]];
    out[0x6] = T_00526CAF[memory[61]];
    memory[79] = T_004AB779[out[0x9]];
    memory[60] = T_004139D1[memory[61]];
    memory[56] = T_005AFC32[memory[93]];
    memory[61] = TH_00470304[memory[24]];
    memory[32] = T_005288C4[memory[93]];
    memory[35] = T16_004EF23E[memory[84]][memory[35]];
    memory[11] = T16_004EF23E[memory[68]][memory[12]];
    memory[1] = T_005D945F[memory[94]];
    memory[7] = T16_0050C7B8[memory[41]][out[0xc]];
    memory[41] = TH_004D8446[memory[35]];
    memory[27] = T_005A76A3[memory[35]];
    memory[95] = T16_0050C7B8[memory[27]][memory[42]];
    memory[0] = T_0052231A[out[0x3]];
    memory[16] = TH_004663A4[memory[35]];
    memory[71] = T_0042628A[out[0x3]];
    memory[24] = T_004C0931[key[0xa]];
    memory[19] = T16_0050C7B8[memory[17]][memory[71]];
    memory[20] = T16_0050C7B8[memory[25]][memory[97]];
    memory[4] = T_0040D60B[out[0x0]];
    memory[3] = T16_004EF23E[memory[45]][memory[99]];
    memory[76] = T16_0050C7B8[memory[4]][memory[60]];
    memory[99] = T_005730DD[memory[3]];
    memory[9] = TH_004E7DAB[memory[94]];
    memory[31] = T16_0050C7B8[memory[16]][memory[23]];
    memory[67] = T_005E0141[memory[11]];
    memory[47] = TH_004D925D[memory[3]];
    memory[80] = T_004A7DF3[out[0x9]];
    memory[58] = TH_00525ABF[memory[11]];
    memory[54] = T_005C53AA[out[0x0]];
    memory[74] = T_005EA1E4[memory[11]];
    out[0x7] = T_0042FFBB[out[0x3]];
    out[0x4] = T_0042ABCA[memory[3]];
    out[0xa] = T16_0050C7B8[memory[48]][memory[0]];
    memory[27] = T16_0050C7B8[out[0x2]][out[0x7]];
    memory[4] = T16_004EF23E[out[0x5]][memory[92]];
    memory[97] = T16_00415EFE[memory[24]][memory[26]];
    memory[8] = T16_00415EFE[memory[74]][memory[53]];
    out[0x8] = T16_00415EFE[out[0x4]][memory[61]];
    memory[70] = T16_00415EFE[memory[67]][memory[63]];
    memory[68] = T16_004EF23E[memory[14]][memory[97]];
    memory[46] = TH_004BD577[memory[11]];
    memory[0] = T_0040F199[memory[68]];
    memory[97] = T16_00415EFE[memory[47]][memory[37]];
    memory[52] = T_0053DB26[memory[4]];
    memory[28] = T16_004EF23E[memory[7]][out[0x8]];
    memory[89] = T16_0050C7B8[memory[54]][out[0x6]];
    memory[87] = TH_005A54C3[memory[28]];
    memory[73] = T16_00415EFE[memory[56]][memory[0]];
    memory[30] = T_0049D1EE[memory[4]];
    memory[94] = T_005224A6[memory[3]];
    out[0x5] = T16_00415EFE[memory[99]][memory[62]];
    memory[15] = T16_004EF23E[memory[89]][memory[97]];
    memory[85] = T16_0050C7B8[memory[52]][memory[9]];
    memory[46] = T16_00415EFE[memory[46]][memory[98]];
    memory[0] = T_0040D1B5[memory[15]];
    memory[33] = T_0051D9B2[memory[15]];
    memory[53] = TH_00604EFC[memory[28]];
    memory[56] = TH_006107F5[memory[15]];
    memory[92] = T16_0050C7B8[memory[30]][memory[22]];
    memory[62] = T_0057F791[memory[28]];
    memory[14] = T_005FDEF0[memory[68]];
    out[0xc] = T16_0050C7B8[memory[36]][memory[39]];
    memory[23] = T_005010F6[memory[28]];
    memory[25] = T16_00415EFE[memory[58]][memory[38]];
    memory[6] = T_00461B15[memory[68]];
    memory[63] = T16_004EF23E[memory[92]][memory[46]];
    memory[67] = T_0049542C[memory[68]];
    memory[48] = T_004C5A48[key[0x2]];
    memory[5] = T16_0050C7B8[memory[48]][memory[2]];
    memory[54] = T_00470A1D[memory[63]];
    memory[3] = T16_0050C7B8[memory[41]][memory[66]];
    out[0x6] = T16_004EF23E[memory[85]][memory[8]];
    out[0x4] = T16_0050C7B8[memory[54]][memory[23]];
    memory[69] = T_00437DF4[memory[35]];
    memory[7] = T16_004EF23E[memory[20]][memory[73]];
    memory[13] = T_0047E3EE[memory[63]];
    memory[81] = TH_0055E47C[memory[7]];
    memory[36] = T16_00415EFE[memory[32]][memory[6]];
    memory[97] = TH_004DD93D[memory[4]];
    memory[99] = T16_00415EFE[memory[94]][memory[91]];
    memory[17] = T16_0050C7B8[memory[69]][memory[40]];
    memory[24] = T16_004EF23E[out[0xa]][memory[36]];
    memory[49] = T_00541C75[out[0x6]];
    memory[75] = T_004BE72D[memory[24]];
    memory[28] = T16_004EF23E[memory[76]][out[0x5]];
    memory[18] = T16_004EF23E[out[0xc]][memory[99]];
    memory[40] = T_005E11D2[memory[18]];
    out[0xc] = T_004CAFED[memory[15]];
    memory[45] = T_00591CAB[memory[18]];
    memory[85] = TH_0057A64B[memory[4]];
    memory[69] = TH_005D83F4[memory[24]];
    memory[54] = T_005AEB8E[out[0x6]];
    memory[10] = T16_0050C7B8[memory[13]][memory[53]];
    memory[4] = T_0057E97B[memory[24]];
    out[0x7] = T_00555B85[memory[18]];
    memory[91] = TH_0048749F[memory[28]];
    memory[58] = T16_00415EFE[out[0xb]][memory[14]];
    memory[55] = T_005E028B[memory[28]];
    memory[20] = TH_0041135D[memory[93]];
    memory[50] = T16_0050C7B8[memory[97]][memory[78]];
    memory[74] = T16_004EF23E[memory[50]][memory[70]];
    memory[73] = T16_004EF23E[memory[19]][memory[58]];
    memory[26] = TH_005DD41F[memory[18]];
    memory[82] = T_00583200[memory[7]];
    memory[53] = T_00530278[memory[74]];
    memory[47] = T_006115AF[memory[7]];
    memory[8] = TH_0048CD52[memory[73]];
    out[0x9] = T_004773C7[memory[73]];
    memory[37] = T16_00415EFE[memory[53]][memory[91]];
    memory[86] = T_0045AA97[out[0x6]];
    out[0x2] = TH_0047ABFC[memory[24]];
    memory[68] = T_0052B582[out[0x6]];
    out[0xb] = T16_00415EFE[memory[20]][memory[67]];
    memory[12] = T_00543833[memory[73]];
    memory[32] = T16_004EF23E[memory[5]][memory[29]];
    memory[60] = T_00566596[memory[7]];
    memory[66] = T_004D6FF1[memory[32]];
    memory[22] = T16_00415EFE[memory[66]][memory[83]];
    memory[13] = TH_00608432[memory[32]];
    memory[71] = T16_0050C7B8[memory[85]][memory[1]];
    out[0xf] = TH_00559A77[memory[63]];
    memory[16] = T_0054C671[memory[32]];
    memory[20] = T_004396AD[memory[74]];
    memory[19] = T_0058B151[memory[32]];
    memory[91] = T16_00415EFE[memory[16]][memory[79]];
    memory[7] = T16_00415EFE[memory[13]][memory[64]];
    memory[65] = T_00549735[memory[28]];
    memory[67] = TH_004BD9FB[memory[28]];
    memory[66] = T_00585FFA[memory[74]];
    memory[88] = T_005F6EBF[memory[73]];
    memory[85] = T16_004EF23E[memory[17]][memory[91]];
    out[0xe] = T16_00415EFE[memory[20]][memory[55]];
    memory[11] = T_00499114[memory[85]];
    memory[34] = T_005E3BF8[memory[85]];
    memory[76] = T16_00415EFE[memory[66]][memory[65]];
    memory[38] = T16_00415EFE[memory[19]][memory[80]];
    memory[55] = T_0044EC23[memory[74]];
    memory[5] = TH_0043764D[memory[85]];
    memory[21] = T16_004EF23E[memory[31]][memory[38]];
    memory[23] = T16_004EF23E[memory[71]][memory[25]];
    memory[89] = T16_004EF23E[memory[95]][memory[22]];
    out[0x8] = T_005F0DA7[memory[85]];
    memory[71] = T16_004EF23E[memory[3]][memory[7]];
    memory[66] = T16_00415EFE[memory[55]][memory[67]];
    memory[44] = T_00535749[memory[89]];
    memory[42] = T_0059EC14[memory[23]];
    memory[1] = T_004B5649[memory[89]];
    memory[30] = T16_00415EFE[memory[56]][memory[1]];
    memory[52] = T16_00415EFE[memory[0]][memory[44]];
    memory[51] = TH_005C0149[memory[21]];
    memory[96] = T_004DB9FF[memory[71]];
    memory[31] = T16_0050C7B8[memory[96]][memory[8]];
    memory[70] = T16_004EF23E[memory[31]][out[0xe]];
    memory[65] = TH_0043344D[memory[70]];
    memory[95] = T16_0050C7B8[out[0xf]][memory[87]];
    memory[15] = T_006055B8[memory[21]];
    memory[24] = T16_00415EFE[memory[60]][memory[42]];
    memory[39] = TH_00429AEC[memory[71]];
    memory[91] = TH_004592D9[memory[70]];
    out[0x0] = T16_0050C7B8[memory[39]][memory[88]];
    memory[55] = T16_00415EFE[memory[51]][memory[4]];
    memory[1] = T_0044A435[memory[89]];
    memory[51] = T_004AA81E[memory[70]];
    memory[31] = T_00462734[memory[23]];
    memory[42] = T16_0050C7B8[memory[26]][memory[5]];
    memory[4] = T_004EEAB1[memory[63]];
    memory[85] = T_005F8F99[memory[71]];
    memory[99] = TH_00564E89[memory[70]];
    memory[35] = T16_0050C7B8[memory[45]][memory[34]];
    memory[98] = T_004CBC82[memory[23]];
    memory[50] = T_005A721A[memory[89]];
    memory[72] = T16_0050C7B8[memory[40]][out[0x8]];
    memory[13] = T_00546C5D[memory[21]];
    memory[8] = T16_0050C7B8[out[0x7]][memory[11]];
    memory[64] = T16_00415EFE[memory[81]][memory[31]];
    memory[78] = T16_00415EFE[memory[33]][memory[50]];
    memory[92] = T16_00415EFE[memory[15]][out[0x2]];
    memory[87] = T_005F2816[memory[21]];
    memory[83] = T16_00415EFE[out[0xc]][memory[1]];
    memory[16] = T16_004EF23E[memory[27]][out[0xb]];
    memory[88] = T_00503165[memory[71]];
    memory[27] = T16_00415EFE[memory[47]][memory[98]];
    out[0x7] = T_005410C6[memory[16]];
    memory[90] = TH_005BC8E9[memory[16]];
    memory[46] = T16_0050C7B8[memory[4]][memory[62]];
    memory[26] = T16_004EF23E[memory[95]][memory[55]];
    memory[74] = T16_0050C7B8[memory[88]][memory[12]];
    memory[55] = TH_00453254[memory[26]];
    memory[39] = T16_004EF23E[memory[72]][memory[24]];
    memory[73] = T16_004EF23E[memory[42]][memory[27]];
    memory[41] = T_0040B54E[memory[16]];
    memory[84] = T_00441529[memory[73]];
    memory[24] = TH_004B25ED[memory[73]];
    memory[40] = T16_004EF23E[memory[74]][memory[37]];
    memory[77] = T16_004EF23E[out[0x0]][memory[76]];
    memory[72] = T_004C74F4[memory[73]];
    out[0x8] = T_004E0EE9[memory[77]];
    memory[6] = TH_0058E478[memory[77]];
    memory[93] = T16_00415EFE[memory[13]][memory[75]];
    memory[5] = TH_0040C767[memory[39]];
    memory[71] = T_004469A3[memory[23]];
    memory[70] = T_00541346[memory[40]];
    out[0xd] = T16_004EF23E[memory[10]][memory[92]];
    memory[32] = T_00606A9F[memory[40]];
    memory[28] = T16_004EF23E[memory[35]][memory[64]];
    memory[0] = T16_0050C7B8[memory[90]][memory[54]];
    memory[42] = TH_004A37BF[memory[73]];
    memory[81] = T_005A9BBC[memory[39]];
    memory[75] = T16_0050C7B8[memory[41]][memory[68]];
    memory[63] = T_005BD923[memory[26]];
    memory[18] = T16_00415EFE[memory[55]][memory[72]];
    out[0x1] = T_0047DC4C[memory[77]];
    memory[1] = T_0044218C[memory[40]];
    memory[4] = T16_00415EFE[memory[87]][memory[69]];
    memory[57] = T_00435CA2[memory[28]];
    out[0xc] = T16_004EF23E[memory[46]][memory[4]];
    memory[46] = TH_00440BA0[memory[28]];
    memory[88] = T_00466985[memory[40]];
    out[0x3] = T_00404090[memory[26]];
    memory[41] = TH_00497EBD[memory[39]];
    memory[37] = T16_0050C7B8[memory[85]][out[0x9]];
    memory[50] = T16_004EF23E[memory[75]][memory[78]];
    memory[11] = TH_00429661[memory[28]];
    memory[89] = TH_0045221F[memory[50]];
    out[0xe] = T_0052750E[memory[50]];
    memory[90] = T16_004EF23E[memory[37]][memory[66]];
    memory[76] = T16_00415EFE[out[0x3]][memory[24]];
    memory[34] = T_005D88E5[out[0xd]];
    out[0xf] = T_00612B48[out[0xc]];
    memory[62] = T_00574BF5[memory[90]];
    out[0x3] = T16_004EF23E[memory[0]][memory[52]];
    memory[47] = T16_00415EFE[memory[63]][memory[84]];
    out[0x2] = TH_005519E3[out[0x3]];
    memory[44] = T16_00415EFE[memory[57]][out[0x1]];
    memory[68] = TH_00469A81[memory[39]];
    memory[74] = T_004A9510[out[0xc]];
    memory[14] = T_004AB89F[out[0xd]];
    memory[15] = T_00507B3A[memory[90]];
    memory[43] = TH_005B9E28[memory[28]];
    memory[98] = T_00505359[memory[50]];
    out[0x6] = TH_00476B82[memory[77]];
    memory[29] = T16_004EF23E[out[0x4]][memory[93]];
    memory[94] = T_005845E6[out[0xc]];
    memory[75] = T_005BACEF[out[0xc]];
    memory[60] = T16_0050C7B8[memory[91]][out[0x2]];
    memory[91] = T16_00415EFE[memory[11]][out[0x6]];
    memory[36] = TH_0053159F[memory[50]];
    memory[7] = TH_0052151A[out[0xd]];
    memory[53] = T16_00415EFE[memory[36]][memory[34]];
    memory[12] = TH_0060B819[out[0xd]];
    memory[4] = TH_0060919E[out[0x3]];
    out[0xb] = T_005B0C5F[memory[29]];
    out[0x1] = TH_004933A7[memory[29]];
    memory[20] = T16_00415EFE[memory[89]][memory[7]];
    memory[37] = T16_00415EFE[memory[43]][memory[6]];
    memory[61] = T16_00415EFE[memory[82]][memory[71]];
    memory[50] = T16_0050C7B8[out[0x7]][memory[49]];
    memory[66] = T16_00415EFE[memory[98]][memory[12]];
    memory[7] = T16_004EF23E[memory[8]][memory[61]];
    memory[43] = T16_004EF23E[memory[60]][memory[47]];
    memory[13] = T_00503DEB[memory[43]];
    memory[10] = T_005BC40E[memory[90]];
    memory[35] = T16_0050C7B8[out[0xb]][memory[41]];
    memory[39] = T_005524BB[memory[43]];
    memory[92] = T_004C21E9[memory[29]];
    memory[33] = T16_00415EFE[memory[46]][out[0x8]];
    out[0x8] = T_0050C539[memory[90]];
    out[0xd] = T_0040BBDF[memory[16]];
    memory[93] = TH_00546068[memory[43]];
    memory[78] = T_00467E37[memory[7]];
    memory[3] = T_0059DFCA[out[0x3]];
    memory[40] = T16_0050C7B8[out[0x1]][memory[81]];
    memory[60] = T16_0050C7B8[memory[78]][out[0x8]];
    memory[82] = T16_004EF23E[memory[50]][memory[83]];
    memory[69] = T16_0050C7B8[out[0xd]][memory[86]];
    memory[72] = T_0058FC77[memory[7]];
    memory[47] = T_005089E2[memory[43]];
    out[0xd] = T_004122F3[memory[26]];
    memory[25] = T16_00415EFE[out[0xe]][memory[14]];
    out[0x8] = TH_00579905[memory[7]];
    memory[26] = T_005618D3[memory[82]];
    memory[8] = T16_0050C7B8[out[0x8]][memory[15]];
    memory[15] = T_005C0F53[memory[29]];
    memory[55] = T16_004EF23E[memory[69]][memory[30]];
    memory[11] = T16_0050C7B8[memory[15]][memory[68]];
    memory[15] = T16_0050C7B8[memory[72]][memory[62]];
    memory[81] = T16_004EF23E[memory[60]][memory[66]];
    memory[16] = T16_00415EFE[out[0xd]][memory[42]];
    memory[80] = T16_0050C7B8[memory[99]][memory[4]];
    memory[49] = TH_00443980[memory[7]];
    memory[69] = T16_0050C7B8[memory[65]][memory[3]];
    memory[64] = TH_0049E8FD[memory[81]];
    out[0x8] = T_0042CA59[memory[55]];
    out[0x6] = T16_004EF23E[memory[8]][memory[53]];
    memory[84] = T_00441B5F[memory[55]];
    memory[21] = T16_0050C7B8[memory[84]][memory[74]];
    memory[6] = T_005F8715[out[0x6]];
    memory[53] = T16_004EF23E[memory[21]][memory[37]];
    memory[21] = T16_004EF23E[memory[80]][memory[16]];
    out[0x0] = T_0043465C[memory[21]];
    memory[41] = T_00590BF8[memory[53]];
    memory[23] = TH_005E929C[memory[81]];
    out[0x7] = T_004B6728[out[0x6]];
    memory[65] = T_005C1377[memory[55]];
    memory[85] = T_0050B6CB[memory[55]];
    memory[57] = T16_0050C7B8[memory[92]][memory[5]];
    out[0x2] = T_00412DB0[out[0x3]];
    memory[12] = T16_00415EFE[memory[70]][memory[26]];
    out[0x9] = T16_00415EFE[memory[6]][memory[93]];
    memory[5] = T_00566C35[memory[81]];
    memory[86] = T_005F19FE[memory[82]];
    out[0x5] = T_004BF574[memory[82]];
    memory[8] = T16_0050C7B8[memory[49]][memory[10]];
    memory[98] = T16_004EF23E[memory[69]][memory[76]];
    memory[61] = T16_0050C7B8[memory[65]][memory[94]];
    memory[4] = T_004C2FA0[out[0x6]];
    memory[63] = T_004AC243[memory[53]];
    memory[27] = T16_00415EFE[memory[4]][memory[47]];
    memory[50] = T_00494CC6[memory[98]];
    memory[77] = T16_004EF23E[memory[61]][memory[91]];
    memory[58] = TH_00445D16[memory[77]];
    memory[80] = TH_005729D8[memory[77]];
    memory[30] = T16_0050C7B8[memory[23]][memory[50]];
    memory[17] = T_00595042[memory[53]];
    memory[97] = TH_005B25D2[memory[77]];
    memory[10] = T16_0050C7B8[memory[51]][out[0x2]];
    memory[52] = T16_0050C7B8[memory[85]][out[0xf]];
    memory[36] = T_0053BEA6[memory[81]];
    out[0xe] = T16_004EF23E[memory[15]][memory[25]];
    out[0xf] = T16_0050C7B8[out[0x8]][memory[75]];
    out[0x4] = T_0048E52A[memory[21]];
    memory[92] = T16_004EF23E[memory[10]][memory[18]];
    memory[78] = T16_004EF23E[memory[52]][memory[33]];
    memory[3] = T16_004EF23E[memory[35]][memory[12]];
    memory[10] = T_00531E4C[memory[78]];
    memory[49] = T_00456878[memory[78]];
    memory[75] = T16_004EF23E[memory[8]][memory[20]];
    out[0xa] = T_0055DFF0[memory[21]];
    memory[23] = T_00567088[memory[92]];
    memory[31] = T_004B0474[memory[75]];
    memory[7] = T16_00415EFE[out[0x7]][memory[13]];
    memory[16] = T_00455281[memory[75]];
    memory[25] = T_004CDF34[memory[75]];
    memory[90] = T_004AACCC[memory[3]];
    memory[89] = T_004E1386[memory[75]];
    memory[33] = T_005D03FD[memory[92]];
    memory[55] = T_005F9DCB[memory[78]];
    out[0x7] = T_005E2680[memory[98]];
    memory[70] = T16_0050C7B8[memory[33]][memory[41]];
    memory[24] = T_0052A590[memory[92]];
    memory[2] = TH_0045CE4E[out[0xe]];
    memory[61] = T_00471AE2[memory[53]];
    memory[67] = T_0050A4E5[memory[3]];
    memory[85] = TH_0043627D[memory[98]];
    memory[79] = T_00590054[memory[98]];
    memory[60] = T_0043D247[memory[82]];
    memory[51] = TH_00431F0C[out[0xe]];
    memory[69] = T_0046CFB3[memory[3]];
    memory[95] = T16_0050C7B8[memory[23]][memory[63]];
    memory[62] = TH_004059EB[out[0xe]];
    out[0xd] = T16_004EF23E[out[0xf]][memory[44]];
    memory[26] = T16_00415EFE[memory[90]][memory[62]];
    memory[38] = T16_00415EFE[memory[67]][memory[51]];
    memory[87] = T16_00415EFE[memory[69]][memory[2]];
    out[0xb] = T16_00415EFE[memory[88]][memory[60]];
    memory[76] = T16_004EF23E[memory[11]][out[0xb]];
    memory[20] = T_0044961E[memory[76]];
    memory[74] = TH_004140DE[out[0xd]];
    memory[62] = TH_0052502C[memory[76]];
    memory[73] = T16_00415EFE[memory[97]][memory[62]];
    out[0x3] = T16_004EF23E[memory[95]][memory[38]];
    memory[11] = TH_0046FE7A[out[0xd]];
    memory[62] = T_00411850[out[0x3]];
    memory[9] = T16_00415EFE[memory[32]][memory[86]];
    memory[72] = T16_004EF23E[memory[70]][memory[26]];
    memory[28] = TH_0047B8D1[out[0xd]];
    out[0xc] = T_0043A044[memory[21]];
    memory[54] = T16_00415EFE[memory[80]][memory[20]];
    memory[4] = TH_00597442[memory[3]];
    memory[78] = T_0058A86E[memory[78]];
    memory[59] = T_0057869A[memory[72]];
    memory[95] = TH_005D05A8[memory[72]];
    memory[65] = T_00615EFA[memory[72]];
    memory[97] = T16_00415EFE[out[0x0]][memory[74]];
    memory[52] = T_0047C9A1[out[0xd]];
    memory[71] = T16_00415EFE[memory[1]][out[0x5]];
    memory[94] = T16_004EF23E[memory[57]][memory[9]];
    memory[68] = T_005755C6[memory[77]];
    memory[26] = T_005D4BF9[memory[92]];
    out[0x8] = T16_004EF23E[memory[40]][memory[71]];
    memory[80] = T_00454971[memory[94]];
    memory[23] = T16_00415EFE[out[0x4]][memory[28]];
    memory[75] = T16_0050C7B8[memory[5]][out[0x7]];
    memory[67] = T_004BDEF0[out[0x8]];
    memory[40] = T_0048EEA9[memory[94]];
    memory[5] = T16_0050C7B8[memory[24]][memory[61]];
    out[0x5] = T16_0050C7B8[memory[67]][memory[16]];
    out[0xd] = T16_0050C7B8[memory[49]][memory[40]];
    out[0x7] = T16_004EF23E[memory[75]][memory[73]];
    memory[9] = T16_004EF23E[memory[5]][memory[87]];
    memory[1] = TH_0057074D[memory[9]];
    memory[29] = T_004E7093[out[0x8]];
    memory[14] = T_005E883D[memory[94]];
    memory[16] = T_0050AF89[out[0xe]];
    memory[40] = T_00586378[out[0x3]];
    out[0xb] = TH_004E2F62[out[0x7]];
    memory[83] = T16_0050C7B8[memory[10]][memory[80]];
    memory[41] = T_005E3418[memory[72]];
    memory[2] = TH_0050B219[memory[9]];
    memory[34] = TH_00526850[out[0x7]];
    memory[67] = T_005266E5[out[0x7]];
    memory[88] = T16_0050C7B8[memory[78]][memory[14]];
    out[0x1] = T_0061373C[memory[76]];
    memory[51] = T16_00415EFE[out[0xc]][memory[11]];
    memory[0] = T16_0050C7B8[memory[36]][memory[85]];
    memory[45] = T16_004EF23E[memory[83]][out[0x9]];
    memory[33] = T_0049763E[out[0x3]];
    memory[3] = T_00562A1B[memory[45]];
    memory[53] = TH_00466CAF[memory[45]];
    memory[42] = T_0048F7D0[out[0x7]];
    memory[73] = T16_00415EFE[memory[4]][memory[16]];
    memory[8] = T16_004EF23E[memory[0]][memory[54]];
    memory[78] = T16_0050C7B8[memory[64]][memory[79]];
    memory[38] = T_005BEA12[out[0x6]];
    memory[28] = T16_004EF23E[out[0xd]][memory[7]];
    out[0xe] = T16_00415EFE[memory[38]][memory[39]];
    memory[49] = TH_0059234C[memory[45]];
    out[0x2] = T_005AC690[memory[9]];
    memory[4] = T16_0050C7B8[memory[26]][memory[17]];
    memory[37] = T16_00415EFE[out[0xa]][memory[52]];
    memory[90] = TH_004E5B97[memory[28]];
    memory[92] = T_0042E454[memory[8]];
    memory[72] = T_004457FF[out[0x8]];
    memory[56] = T_005AE24F[memory[28]];
    memory[48] = T16_004EF23E[out[0x5]][memory[37]];
    memory[83] = T_005FD54E[memory[94]];
    memory[10] = T16_0050C7B8[memory[72]][memory[89]];
    out[0x4] = T16_004EF23E[memory[4]][memory[73]];
    memory[72] = T16_004EF23E[memory[10]][memory[23]];
    memory[75] = T16_00415EFE[memory[1]][memory[90]];
    memory[16] = T16_004EF23E[memory[88]][memory[27]];
    memory[70] = TH_004B19F5[memory[28]];
    memory[87] = T_004B73DA[memory[72]];
    memory[45] = TH_004D06C9[memory[45]];
    memory[52] = T_004B8D39[memory[16]];
    memory[96] = T_005A6E0C[memory[72]];
    out[0xf] = TH_004AFA74[memory[76]];
    memory[88] = T16_0050C7B8[memory[29]][memory[25]];
    memory[38] = TH_0050082B[memory[8]];
    memory[35] = T_004022E4[out[0x4]];
    memory[63] = TH_0057E0F3[memory[48]];
    memory[98] = T_004D1070[memory[16]];
    memory[23] = T_00468A34[memory[8]];
    memory[10] = T_0045A3D0[memory[8]];
    memory[80] = T_004D32C1[out[0x4]];
    memory[1] = T16_00415EFE[memory[68]][out[0x1]];
    memory[71] = T_00585D47[memory[72]];
    memory[21] = T_00506D45[memory[48]];
    out[0x9] = T16_0050C7B8[memory[80]][memory[49]];
    memory[22] = T_004B985B[memory[72]];
    memory[76] = T16_0050C7B8[memory[10]][memory[40]];
    memory[35] = T16_0050C7B8[memory[35]][memory[3]];
    memory[26] = T_0057B1F7[memory[16]];
    memory[11] = T_0040898F[out[0x3]];
    memory[60] = T_005BE44A[memory[48]];
    memory[99] = TH_0042BB10[out[0x8]];
    memory[85] = T16_00415EFE[memory[52]][memory[22]];
    memory[80] = T_004E524B[memory[16]];
    out[0x8] = T16_0050C7B8[memory[92]][memory[62]];
    memory[4] = T_005DDD0F[memory[48]];
    memory[90] = T16_00415EFE[memory[21]][memory[34]];
    memory[46] = T16_00415EFE[memory[60]][memory[67]];
    memory[77] = T16_00415EFE[memory[2]][memory[70]];
    memory[76] = T16_004EF23E[memory[76]][memory[85]];
    memory[6] = T_00447776[memory[76]];
    out[0x6] = T16_0050C7B8[memory[99]][memory[31]];
    out[0x6] = T16_004EF23E[out[0x6]][memory[51]];
    out[0x7] = T_0044C23E[out[0x6]];
    memory[12] = T16_004EF23E[memory[88]][memory[97]];
    memory[72] = T16_004EF23E[memory[30]][memory[1]];
    memory[44] = T16_0050C7B8[memory[23]][memory[11]];
    memory[57] = T_00461EEF[memory[72]];
    memory[50] = TH_0058A368[memory[9]];
    memory[83] = T16_0050C7B8[memory[55]][memory[83]];
    memory[55] = T_0040FAF9[out[0x4]];
    out[0xd] = T_004967DE[memory[28]];
    memory[7] = T16_00415EFE[memory[80]][memory[96]];
    out[0x3] = TH_004AA14A[memory[72]];
    memory[85] = TH_0048ADD9[out[0x6]];
    memory[67] = TH_005512C2[memory[12]];
    memory[49] = T_0058048E[memory[12]];
    memory[23] = T16_00415EFE[memory[26]][memory[71]];
    memory[31] = T_0043E179[memory[72]];
    memory[74] = T16_0050C7B8[memory[55]][memory[53]];
    memory[10] = T_004ACA7D[memory[76]];
    memory[25] = T_005C8BD0[out[0x4]];
    memory[71] = T16_00415EFE[memory[50]][memory[56]];
    memory[70] = T16_0050C7B8[memory[38]][memory[33]];
    memory[2] = T_0046F733[memory[76]];
    memory[28] = T16_0050C7B8[memory[25]][memory[45]];
    memory[32] = TH_0051D10B[memory[12]];
    memory[22] = T16_00415EFE[memory[98]][memory[87]];
    out[0xa] = T16_004EF23E[memory[83]][out[0xe]];
    memory[84] = T16_004EF23E[memory[44]][memory[22]];
    memory[53] = T16_00415EFE[memory[58]][out[0xf]];
    memory[3] = TH_004E1D3C[out[0xa]];
    memory[93] = T16_004EF23E[out[0x8]][memory[7]];
    memory[91] = T16_004EF23E[memory[74]][memory[46]];
    memory[68] = T_0052BCAF[memory[93]];
    memory[74] = T_004EDB4B[memory[91]];
    memory[45] = T_004BB307[memory[93]];
    memory[87] = T16_00415EFE[memory[63]][out[0xb]];
    memory[52] = T16_0050C7B8[out[0x7]][memory[31]];
    memory[97] = TH_00451B46[memory[93]];
    out[0x0] = T_005DEAEF[memory[84]];
    memory[17] = T16_004EF23E[memory[28]][memory[90]];
    out[0xc] = TH_0060AD23[memory[84]];
    memory[8] = T_0047EE61[memory[91]];
    memory[34] = T_00403870[memory[91]];
    memory[22] = TH_00509804[memory[91]];
    out[0x7] = TH_00575BFD[memory[84]];
    memory[80] = T16_00415EFE[out[0x2]][out[0xd]];
    memory[47] = T_0045C770[memory[17]];
    memory[42] = T16_00415EFE[memory[4]][memory[42]];
    memory[18] = T16_0050C7B8[memory[85]][out[0x3]];
    memory[66] = TH_0061171D[out[0xa]];
    out[0x5] = T16_004EF23E[memory[78]][memory[53]];
    memory[11] = TH_004A4B3E[memory[17]];
    memory[61] = T_0044453C[memory[84]];
    memory[28] = T16_004EF23E[memory[35]][memory[87]];
    memory[83] = T_005C333B[memory[28]];
    memory[50] = TH_0045BAA9[memory[93]];
    memory[54] = T_004575BB[memory[76]];
    memory[26] = T16_004EF23E[memory[70]][memory[23]];
    memory[90] = T_004CE14D[out[0x5]];
    memory[4] = T_0045A1DD[memory[72]];
    memory[72] = T_004A4174[memory[26]];
    out[0x3] = T16_00415EFE[memory[90]][memory[41]];
    memory[88] = T_0049AF5C[out[0xa]];
    memory[23] = T16_0050C7B8[memory[72]][memory[34]];
    memory[43] = T_004D348E[out[0x5]];
    memory[1] = TH_00428681[memory[28]];
    out[0x1] = T_004B4D42[out[0x6]];
    memory[86] = T_00591DD0[memory[28]];
    memory[7] = T16_004EF23E[memory[52]][memory[75]];
    memory[13] = T_005C25A0[memory[12]];
    memory[81] = T16_0050C7B8[memory[3]][memory[32]];
    memory[15] = TH_004072D4[memory[7]];
    memory[52] = T_00544F66[memory[26]];
    memory[87] = T_00406B98[memory[28]];
    memory[76] = TH_00432ECE[memory[17]];
    memory[28] = T_005D5C65[out[0x6]];
    memory[19] = T16_0050C7B8[memory[52]][memory[8]];
    memory[56] = T16_0050C7B8[memory[66]][memory[13]];
    memory[8] = T16_004EF23E[out[0x9]][memory[42]];
    memory[93] = T_0048DAA1[memory[7]];
    memory[96] = T16_0050C7B8[memory[28]][memory[57]];
    memory[12] = T_0045E969[out[0x5]];
    memory[92] = T_005B988F[out[0xa]];
    memory[72] = T_00540038[memory[7]];
    memory[32] = T_0055300B[memory[8]];
    memory[70] = T_0051E414[memory[26]];
    memory[53] = T16_0050C7B8[out[0x1]][memory[4]];
    memory[14] = T_004D8DDE[memory[8]];
    memory[60] = T_005736DC[memory[8]];
    memory[30] = T16_00415EFE[memory[12]][memory[65]];
    memory[58] = T_004CAD58[memory[8]];
    memory[39] = T16_0050C7B8[memory[70]][memory[74]];
    memory[3] = T16_00415EFE[memory[50]][memory[14]];
    memory[77] = T16_004EF23E[memory[18]][memory[77]];
    memory[46] = T16_0050C7B8[memory[88]][memory[67]];
    memory[66] = T_0053E57B[memory[77]];
    memory[33] = T16_004EF23E[memory[96]][memory[80]];
    memory[6] = T16_0050C7B8[memory[66]][memory[6]];
    memory[28] = T_0048B93E[memory[33]];
    memory[31] = TH_005C86CF[memory[33]];
    memory[35] = T_0057B697[memory[77]];
    memory[89] = T_00456329[out[0x5]];
    out[0x5] = T_005FF9F3[memory[26]];
    memory[98] = T_0058F67A[memory[17]];
    memory[14] = T_005CC7EF[memory[7]];
    memory[7] = T_00571090[memory[77]];
    memory[79] = T16_0050C7B8[memory[7]][memory[54]];
    memory[78] = T16_0050C7B8[memory[35]][memory[2]];
    memory[70] = T16_00415EFE[memory[43]][memory[59]];
    memory[63] = T16_00415EFE[memory[89]][memory[95]];
    memory[24] = T16_00415EFE[memory[31]][out[0xc]];
    memory[84] = T16_00415EFE[memory[68]][memory[58]];
    out[0xd] = T16_00415EFE[memory[28]][memory[61]];
    memory[41] = T_0054FA90[memory[77]];
    out[0x6] = T16_004EF23E[memory[46]][memory[70]];
    memory[85] = T_005F80BC[out[0x6]];
    memory[52] = T16_0050C7B8[out[0x5]][memory[22]];
    memory[73] = T_00550DB7[out[0x6]];
    memory[68] = TH_00412FD1[out[0x6]];
    memory[70] = T16_00415EFE[memory[83]][memory[73]];
    memory[94] = T16_00415EFE[memory[86]][memory[68]];
    memory[7] = T16_0050C7B8[memory[41]][memory[10]];
    memory[69] = T16_004EF23E[memory[53]][memory[71]];
    out[0xb] = T16_00415EFE[memory[97]][memory[60]];
    memory[67] = T16_004EF23E[memory[6]][memory[70]];
    memory[42] = T_004BC3CE[memory[67]];
    memory[17] = T16_004EF23E[memory[79]][memory[94]];
    memory[68] = T_00408530[memory[69]];
    memory[34] = TH_00536692[memory[69]];
    memory[90] = T16_0050C7B8[memory[92]][memory[49]];
    out[0xa] = TH_005D7C8F[memory[33]];
    memory[38] = TH_00532754[memory[33]];
    memory[4] = T_005EE8F9[out[0x6]];
    memory[71] = TH_00462A6A[memory[69]];
    memory[5] = T16_004EF23E[memory[90]][out[0x3]];
    memory[16] = T_0058CC1C[memory[17]];
    memory[9] = TH_0044A971[memory[67]];
    memory[91] = T_0056066B[memory[69]];
    memory[89] = T_0047E845[memory[5]];
    out[0x5] = T16_004EF23E[memory[81]][memory[30]];
    memory[30] = T_0054A7E2[memory[5]];
    out[0x9] = T16_00415EFE[memory[38]][out[0x7]];
    memory[2] = T_00474CC1[memory[5]];
    memory[75] = T_0053FC6A[memory[17]];
    memory[36] = T_004AE413[memory[5]];
    memory[10] = T16_00415EFE[memory[45]][memory[32]];
    memory[13] = T_004CFFC5[memory[67]];
    memory[99] = T16_004EF23E[memory[56]][memory[63]];
    memory[90] = T16_00415EFE[memory[87]][memory[4]];
    memory[92] = T_0042E929[memory[99]];
    memory[5] = T16_00415EFE[memory[36]][memory[15]];
    memory[88] = T16_0050C7B8[memory[92]][memory[91]];
    memory[62] = T_0046F3BA[memory[67]];
    memory[86] = TH_0056746B[out[0x5]];
    memory[57] = T16_00415EFE[memory[2]][memory[93]];
    memory[67] = T16_004EF23E[memory[7]][memory[90]];
    out[0x2] = T16_0050C7B8[memory[11]][memory[86]];
    out[0xc] = T16_00415EFE[memory[30]][memory[72]];
    memory[56] = TH_0049DCAE[memory[99]];
    memory[51] = T_004D2FCB[memory[67]];
    memory[77] = T_005DD256[out[0x5]];
    memory[38] = T16_004EF23E[memory[39]][out[0xc]];
    out[0xe] = T16_0050C7B8[memory[56]][memory[34]];
    memory[20] = T_00563339[memory[99]];
    memory[87] = T_0056EFE7[memory[67]];
    memory[82] = T_0040608C[memory[38]];
    memory[35] = T_0058AF6B[memory[17]];
    memory[30] = T16_00415EFE[memory[1]][memory[85]];
    memory[31] = T16_004EF23E[out[0x2]][out[0x9]];
    out[0x9] = T16_004EF23E[out[0xe]][memory[3]];
    memory[30] = T16_004EF23E[memory[78]][memory[30]];
    memory[54] = T16_004EF23E[memory[52]][memory[57]];
    memory[12] = TH_005EAAB6[memory[67]];
    out[0xc] = TH_0056ADA8[memory[30]];
    memory[73] = T16_0050C7B8[memory[20]][memory[71]];
    memory[27] = T16_00415EFE[memory[89]][memory[14]];
    memory[44] = T_004ACD42[out[0x5]];
    memory[4] = T_0057DD21[out[0x9]];
    memory[29] = T_00607547[memory[30]];
    memory[18] = T_0042F6E4[memory[54]];
    memory[92] = T_005520E4[memory[99]];
    memory[86] = T_004504B1[memory[67]];
    memory[41] = T_0055DA07[memory[31]];
    memory[53] = TH_00534279[memory[54]];
    memory[3] = T16_0050C7B8[memory[76]][memory[44]];
    memory[83] = TH_00576681[memory[38]];
    memory[43] = T_004B5286[out[0x9]];
    memory[97] = T_005A19A2[memory[38]];
    memory[78] = TH_004C876B[memory[54]];
    memory[56] = T_0040B6EB[memory[31]];
    memory[37] = T_0049EFF5[out[0x9]];
    memory[1] = TH_005B4BDF[out[0x5]];
    memory[66] = T16_0050C7B8[memory[98]][memory[1]];
    memory[0] = TH_004DDF61[memory[54]];
    memory[22] = T16_00415EFE[out[0xa]][out[0x0]];
    out[0x5] = T16_004EF23E[memory[23]][memory[5]];
    memory[99] = TH_004CF9B8[memory[17]];
    memory[59] = T16_004EF23E[memory[66]][memory[22]];
    memory[15] = T16_00415EFE[memory[87]][memory[82]];
    memory[65] = T_00597959[memory[59]];
    out[0xe] = T_005DE68F[out[0x5]];
    memory[55] = T_004897CB[memory[59]];
    memory[96] = T16_00415EFE[memory[37]][memory[42]];
    memory[66] = T16_00415EFE[memory[12]][memory[83]];
    out[0x4] = T_004087F7[memory[30]];
    out[0x7] = T16_00415EFE[memory[4]][memory[13]];
    memory[81] = T_005BEFB4[memory[59]];
    memory[50] = T16_004EF23E[memory[88]][memory[84]];
    memory[26] = TH_005376FF[memory[38]];
    memory[6] = T16_0050C7B8[memory[47]][memory[77]];
    memory[1] = TH_0056FED7[memory[50]];
    memory[64] = TH_0042B2EF[memory[30]];
    memory[34] = T16_004EF23E[memory[19]][memory[27]];
    memory[87] = T16_0050C7B8[memory[64]][out[0xe]];
    memory[52] = T_0059C8DF[out[0x5]];
    memory[47] = T_004644B5[memory[34]];
    memory[44] = T_004AC845[memory[34]];
    memory[60] = T16_0050C7B8[memory[1]][memory[35]];
    memory[94] = T_00401C80[memory[50]];
    memory[35] = TH_005449AD[memory[50]];
    memory[71] = T16_0050C7B8[memory[35]][memory[75]];
    memory[46] = T_00562CCC[out[0x9]];
    memory[42] = T16_0050C7B8[out[0xc]][memory[52]];
    out[0x2] = T16_0050C7B8[memory[92]][memory[68]];
    memory[77] = T16_00415EFE[memory[46]][memory[9]];
    memory[48] = T_0042F91F[memory[34]];
    out[0x1] = TH_005FA43C[out[0x5]];
    out[0x3] = TH_005CE105[memory[31]];
    memory[83] = T16_004EF23E[out[0x2]][memory[10]];
    out[0x6] = T_00583E25[memory[59]];
    memory[80] = T16_004EF23E[memory[73]][out[0xb]];
    memory[89] = TH_005388B7[memory[31]];
    memory[79] = T_0048E003[memory[83]];
    memory[1] = T_0055FDA6[memory[80]];
    memory[95] = T_004C6B9A[memory[80]];
    memory[5] = T16_004EF23E[memory[3]][out[0xd]];
    memory[72] = TH_0055FF52[memory[34]];
    memory[54] = T16_00415EFE[memory[43]][memory[62]];
    memory[61] = T16_0050C7B8[memory[29]][out[0x1]];
    memory[67] = T16_00415EFE[memory[48]][memory[81]];
    memory[30] = T_00451A46[memory[5]];
    memory[40] = T_0043B5F1[memory[83]];
    memory[48] = T16_0050C7B8[memory[41]][memory[79]];
    memory[70] = TH_005D5273[memory[80]];
    memory[35] = T16_00415EFE[memory[72]][memory[55]];
    out[0x0] = T16_00415EFE[memory[51]][memory[97]];
    memory[36] = T_00506B9D[memory[50]];
    out[0x1] = T16_00415EFE[memory[44]][out[0x6]];
    memory[64] = T16_0050C7B8[memory[18]][memory[30]];
    memory[97] = T16_004EF23E[memory[6]][memory[24]];
    memory[35] = T16_004EF23E[memory[71]][memory[35]];
    memory[43] = T16_004EF23E[memory[64]][memory[77]];
    memory[25] = TH_005D371C[memory[97]];
    memory[73] = T_0042CC6B[memory[43]];
    memory[57] = T_005A6860[memory[43]];
    memory[75] = T_005FD18F[memory[43]];
    memory[39] = T_00493F83[memory[5]];
    memory[49] = T_004E78F1[memory[97]];
    memory[69] = T16_00415EFE[memory[25]][memory[70]];
    memory[13] = T16_0050C7B8[memory[56]][memory[40]];
    memory[58] = T16_00415EFE[memory[47]][memory[65]];
    memory[90] = T_0052F77D[memory[35]];
    memory[4] = TH_00537B8B[memory[43]];
    memory[77] = TH_00575775[memory[83]];
    memory[30] = T16_004EF23E[memory[48]][memory[66]];
    memory[10] = TH_004A67C8[memory[83]];
    out[0xd] = T_0041512B[memory[97]];
    memory[72] = TH_005EED05[memory[5]];
    out[0xc] = T16_0050C7B8[memory[53]][memory[39]];
    memory[29] = T16_00415EFE[memory[49]][memory[95]];
    out[0x8] = T16_004EF23E[out[0xc]][memory[54]];
    out[0x2] = TH_004451B7[memory[35]];
    memory[17] = T_0058DA35[out[0x8]];
    memory[23] = TH_005DAF94[memory[30]];
    memory[3] = T16_00415EFE[memory[86]][memory[26]];
    out[0xb] = T_00487994[memory[35]];
    memory[68] = T_00533B5B[out[0x8]];
    memory[66] = T_00408D55[out[0x8]];
    memory[63] = T_005EF150[memory[35]];
    memory[19] = T16_0050C7B8[out[0x3]][memory[10]];
    out[0xa] = T16_004EF23E[memory[42]][memory[29]];
    memory[48] = T16_004EF23E[memory[13]][out[0x0]];
    memory[62] = T16_004EF23E[memory[87]][memory[69]];
    memory[54] = TH_00404A9A[memory[5]];
    memory[34] = T_00606C68[out[0x5]];
    memory[9] = T_004FFABF[memory[30]];
    out[0x3] = TH_004BD0A5[memory[48]];
    out[0x6] = T_004367BF[out[0xa]];
    memory[28] = T16_004EF23E[memory[60]][memory[58]];
    memory[29] = TH_005E970B[memory[48]];
    memory[83] = T_0058D445[memory[62]];
    memory[55] = T_004915B9[memory[28]];
    out[0xc] = T_005CE505[memory[28]];
    memory[65] = T16_0050C7B8[memory[0]][memory[72]];
    memory[20] = T16_0050C7B8[memory[94]][memory[99]];
    memory[10] = T16_0050C7B8[memory[36]][memory[16]];
    memory[64] = TH_005A3F2F[out[0xa]];
    memory[70] = T16_004EF23E[memory[10]][memory[67]];
    memory[26] = T_004C900C[memory[62]];
    memory[11] = TH_004AF055[memory[28]];
    memory[49] = TH_00584F6F[memory[70]];
    memory[69] = T16_004EF23E[memory[19]][memory[3]];
    memory[88] = T_004E93C7[memory[69]];
    memory[32] = T_004086F7[memory[48]];
    memory[50] = T16_0050C7B8[memory[26]][memory[73]];
    memory[2] = T_00493003[memory[62]];
    memory[27] = T16_00415EFE[memory[49]][out[0x6]];
    memory[12] = TH_00535295[memory[69]];
    memory[58] = T16_0050C7B8[memory[89]][memory[77]];
    memory[77] = TH_00490D7F[out[0xa]];
    memory[16] = T16_0050C7B8[memory[12]][out[0x2]];
    memory[86] = T_005E0595[memory[30]];
    memory[25] = T16_0050C7B8[memory[78]][memory[54]];
    memory[52] = T_00463932[memory[48]];
    memory[46] = T_005BAE3C[out[0x8]];
    memory[89] = T_0047129C[memory[97]];
    memory[59] = T_0060BD0F[memory[30]];
    memory[3] = T16_004EF23E[memory[25]][out[0x7]];
    memory[93] = T_00524C3B[memory[62]];
    memory[97] = T_004A51B1[memory[28]];
    memory[91] = T16_004EF23E[memory[20]][out[0x1]];
    memory[81] = T16_00415EFE[memory[89]][memory[1]];
    out[0x0] = TH_004AEBEB[memory[91]];
    memory[0] = T16_0050C7B8[out[0x4]][memory[34]];
    memory[31] = T16_0050C7B8[memory[93]][memory[57]];
    memory[93] = T16_004EF23E[memory[65]][memory[96]];
    out[0xf] = T_00602CED[memory[70]];
    memory[73] = T_005E5E79[memory[93]];
    memory[1] = TH_004583DA[out[0xa]];
    memory[10] = T16_00415EFE[memory[73]][memory[32]];
    memory[18] = T16_0050C7B8[memory[83]][memory[75]];
    memory[82] = T_0044BC1D[memory[93]];
    memory[92] = TH_00609991[memory[3]];
    memory[41] = T16_0050C7B8[memory[92]][memory[86]];
    memory[45] = T_00432D08[memory[70]];
    memory[67] = T_00467517[memory[69]];
    memory[20] = TH_0060E32A[memory[70]];
    memory[47] = T16_0050C7B8[memory[88]][memory[63]];
    memory[63] = T16_00415EFE[memory[82]][memory[29]];
    memory[32] = TH_0051E704[memory[91]];
    memory[34] = T_005D674C[memory[3]];
    memory[82] = T_0054AB7F[memory[69]];
    out[0x8] = T_0052FA24[memory[93]];
    out[0x1] = T16_00415EFE[out[0x8]][out[0x3]];
    memory[98] = T_0057C6B8[memory[91]];
    memory[13] = T16_00415EFE[out[0xf]][memory[64]];
    memory[96] = T16_004EF23E[memory[61]][memory[81]];
    memory[28] = T_005CAA61[memory[96]];
    memory[86] = T16_00415EFE[memory[45]][memory[1]];
    out[0x5] = T16_00415EFE[memory[20]][memory[77]];
    memory[71] = TH_005C34C7[memory[3]];
    memory[60] = T16_0050C7B8[memory[71]][memory[23]];
    memory[94] = TH_0058BECA[memory[80]];
    memory[74] = T_005BDCDA[memory[96]];
    memory[37] = T16_0050C7B8[memory[34]][memory[59]];
    memory[29] = T16_0050C7B8[memory[82]][out[0xb]];
    out[0xa] = T_005BC670[memory[93]];
    memory[39] = T16_0050C7B8[memory[2]][memory[4]];
    memory[81] = T16_00415EFE[out[0xa]][memory[52]];
    out[0xa] = TH_004E3712[memory[3]];
    memory[71] = T16_004EF23E[memory[58]][memory[15]];
    out[0xe] = T16_004EF23E[memory[41]][memory[13]];
    memory[99] = T_005754C6[memory[96]];
    memory[48] = T_005C588B[memory[71]];
    memory[6] = T16_00415EFE[memory[48]][memory[11]];
    memory[59] = T16_00415EFE[out[0xd]][memory[94]];
    memory[52] = T_0049AB28[memory[71]];
    memory[11] = TH_0055D0A8[memory[96]];
    memory[34] = T16_004EF23E[memory[60]][memory[86]];
    out[0x3] = T_004A5D12[out[0xe]];
    memory[13] = T16_004EF23E[memory[31]][memory[6]];
    memory[82] = T_00481426[memory[71]];
    out[0x7] = T16_004EF23E[memory[0]][memory[59]];
    memory[96] = T16_004EF23E[memory[37]][memory[27]];
    memory[93] = T16_0050C7B8[memory[32]][memory[99]];
    out[0xd] = T16_0050C7B8[memory[67]][memory[90]];
    memory[14] = T16_004EF23E[memory[93]][memory[63]];
    memory[4] = T_004C4E3B[out[0x7]];
    out[0x4] = T_00493D6C[memory[14]];
    memory[1] = T_004BC105[out[0x7]];
    out[0x6] = T_00558431[memory[34]];
    memory[99] = TH_00495A03[out[0x7]];
    out[0xf] = T16_0050C7B8[memory[98]][memory[28]];
    memory[35] = T16_00415EFE[memory[82]][out[0xc]];
    memory[95] = T16_0050C7B8[out[0xa]][memory[9]];
    out[0xc] = T16_00415EFE[memory[99]][memory[66]];
    memory[31] = T16_004EF23E[out[0xd]][out[0xc]];
    memory[33] = T16_004EF23E[memory[95]][out[0x5]];
    memory[91] = TH_004133D1[memory[91]];
    memory[9] = T16_00415EFE[memory[1]][memory[68]];
    memory[76] = T16_0050C7B8[out[0x0]][memory[11]];
    out[0xc] = T_005D1023[memory[96]];
    out[0xa] = TH_004B0C3E[memory[31]];
    memory[77] = T16_004EF23E[out[0xf]][memory[10]];
    memory[19] = T16_0050C7B8[memory[91]][memory[74]];
    memory[34] = T_0048D491[memory[71]];
    memory[95] = T16_00415EFE[memory[52]][memory[55]];
    memory[44] = T16_00415EFE[memory[4]][memory[17]];
    out[0xe] = T_0044116A[memory[77]];
    out[0x9] = T_005996B4[memory[33]];
    memory[86] = T16_004EF23E[memory[29]][memory[9]];
    memory[28] = T_00577802[out[0x7]];
    memory[59] = T16_004EF23E[memory[19]][memory[81]];
    out[0x0] = TH_0049CA9E[memory[86]];
    out[0xb] = T_00482BB5[memory[59]];
    memory[64] = T16_00415EFE[memory[34]][memory[97]];
    memory[53] = T16_004EF23E[memory[39]][memory[95]];
    out[0x5] = T_005C2F74[memory[13]];
    out[0xf] = T_0049635D[memory[53]];
    memory[79] = T16_004EF23E[memory[47]][memory[44]];
    memory[17] = T16_004EF23E[memory[76]][out[0x1]];
    memory[26] = T16_004EF23E[memory[50]][memory[64]];
    out[0x2] = T_004977CB[memory[26]];
    memory[59] = T16_00415EFE[memory[28]][memory[46]];
    out[0x1] = T_00534D4A[memory[17]];
    memory[99] = T16_004EF23E[memory[18]][memory[35]];
    out[0x8] = TH_004866A5[memory[99]];
    memory[1] = T16_004EF23E[memory[16]][memory[59]];
    out[0x7] = T_005BA7D5[memory[1]];
    out[0xd] = TH_0048085F[memory[79]];
}

unsigned char is_hex_char(char c)
{
    return (
        (c >= '0' && c <= '9') ||
        (c >= 'a' && c <= 'f') ||
        (c >= 'A' && c <= 'F')
    );
}

int main(int argc, char* argv[])
{
    unsigned char key[16] = {0}, out[16] = {0};  

    if(argc != 2)
    {
        printf("Usage: ./wbaes128 <32 hexa char>\n");
        return EXIT_FAILURE;
    }

    if(strlen(argv[1]) != 32)
        return EXIT_FAILURE;

    for(unsigned int i = 0; i < 32; i += 2)
    {
        if(is_hex_char(argv[1][i]) == 0 || is_hex_char(argv[1][i + 1]) == 0)
            return EXIT_FAILURE;
        
        unsigned char str_bytes[3] = {
            argv[1][i],
            argv[1][i + 1],
            0
        };

        key[ i / 2] = strtoul((const char*)str_bytes, NULL, 16);
    }

    // Tests cases:
    // unsigned char key[16] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF};
    // 00617010  7D CE 69 88|AE 0E 74 8C|89 11 2D 3E|2A C5 F7 CE|
    // unsigned char key[16] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
    // 00617010  44 17 29 0E|96 76 80 ED|47 48 7D 6C|A1 03 99 8B|
    printf("Hexdump key:\n"),
    hexdump(key, 16);

    printf("Hexdump out:\n");
    wbaes128_enc(key, out);
    hexdump(out, 16);
    return EXIT_SUCCESS;
}
